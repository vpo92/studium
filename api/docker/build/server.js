!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t){e.exports=require("express")},function(e,t,n){"use strict";function r(e,t){if(f.db)return t();a.MongoClient.connect(e,function(e,n){return e?t(e):(f.db=n,t())})}function o(){return f.db}function u(e){f.db&&f.db.close(function(t){f.db=null,f.mode=null,e(t)})}var a=n(11),f={db:null};e.exports={connect:r,get:o,close:u}},function(e,t,n){"use strict";var r=n(12),o=function(e){return e&&e.__esModule?e:{default:e}}(r),u=[new o.default.transports.File({name:"ERROR-FILE",filename:"api-error.log",level:"error"}),new o.default.transports.File({name:"ALL-FILE",filename:"api-combined.log"}),new o.default.transports.Console({prettyPrint:!0,showLevel:"debug"})],a=new o.default.Logger({level:"info",transports:u});e.exports=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(0),u=r(o),a=n(4),f=r(a),i=n(5),l=r(i),c=n(6),d=r(c),s=n(7),p=r(s),h=n(1),x=r(h),g=n(2),m=r(g),v=(0,u.default)();v.set("env","production"),v.set("port",3e3),v.use((0,d.default)()),v.use((0,l.default)()),v.use(f.default.json()),v.use(f.default.urlencoded({extended:!0})),v.use("/",p.default);var y=v.get("port");m.default.info("runnning server on 3000"),x.default.connect("mongodb://localhost:27017/studium",function(e){e?(m.default.error(e),process.exit(1)):v.listen(y,"0.0.0.0",function(){m.default.info("process.env.NODE_ENV:production:"),m.default.info("studium-api listening on 0.0.0.0, server_port "+y)})})},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("method-override")},function(e,t){e.exports=require("cors")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),u=r(o),a=n(8),f=r(a),i=u.default.Router();i.use("/prosopography",f.default),t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(0),u=r(o),a=n(9),f=r(a),i=u.default.Router();i.get("/",f.default.findAll),i.get("/search/:searchText",f.default.textSearch),i.get("/index/:letter",f.default.indexSearch),i.get("/:reference",f.default.findByReference),e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){p.default.info("findAll"),d.default.get().collection("prosopography").find().limit(50).toArray().then(l.default.handleData(t)).catch(l.default.handleError(t))}function u(e,t){p.default.info("textSearch"),d.default.get().collection("prosopography").find({$text:{$search:e.params.searchText}},{score:{$meta:"textScore"}}).sort({score:{$meta:"textScore"}}).limit(50).toArray().then(l.default.handleData(t)).catch(l.default.handleError(t))}function a(e,t){p.default.info("indexSearch");var n=e.params.letter,r=new RegExp("^"+n,"g");d.default.get().collection("prosopography").find({"identity.name.value":{$regex:r,$options:"-i"}}).limit(0).toArray().then(l.default.handleData(t)).catch(l.default.handleError(t))}function f(e,t){return p.default.info("findByReference reference:"+e.params.reference),d.default.get().collection("prosopography").findOne({reference:parseInt(e.params.reference)}).then(function(e){p.default.info(e),t.statusCode=200,t.json(e)}).catch(l.default.handleError(t))}var i=n(10),l=r(i),c=n(1),d=r(c),s=n(2),p=r(s);e.exports={findAll:o,indexSearch:a,findByReference:f,textSearch:u}},function(e,t,n){"use strict";t.handleData=function(e){return function(t){e.statusCode=200,e.json(t)}},t.handleError=function(e){return function(t){e.statusCode=500,e.json({error:t})}}},function(e,t){e.exports=require("mongodb")},function(e,t){e.exports=require("winston")}]);